---
title: Installation
---

import { Steps } from '@astrojs/starlight/components';

<Steps>

	1. Install the reflection:

		```bash
		composer require good-php/reflection
		```

	2. Build a reflector:

		```php
		use GoodPhp\Reflection\ReflectorBuilder;

		$reflector = new ReflectorBuilder()
			->withFileCache()
			->withMemoryCache()
			->build();
		```

		:::caution
		Building the reflector is expensive. Make sure you only build it once per process lifetime :)
		:::

</Steps>

## PHPStan extension

A PHPStan extension is shipped with the package. If you're using `phpstan/extension-installer`, it will be
enabled automatically. We recommend keeping it on, but it's not required.

If it's causing you any issues or you just don't want it, you can disable it through your `composer.json`:

```json
{
	"extra": {
		"phpstan/extension-installer": {
			"ignore": ["good-php/reflection"]
		}
	}
}
```

#### If you aren't using `phpstan/extension-installer`

You can, of course, enable it manually in your `phpstan.neon`:

```neon
includes:
	- vendor/good-php/reflection/phpstan-extension.neon
```

## Customizing cache

It's crucial that you use some kind of cache. Out of the box, we support file-based cache and in-memory cache.
They work together - file cache allows faster startup times, while in-memory cache allows accessing the
same reflections repeatedly during the PHP process lifetime.

By default, `->withFileCache()` stores it's cache in `/tmp/good-php-reflection` without any expiration. This
is configurable:

```php
new ReflectorBuilder()
	->withFileCache(
		path: '/other/directory',
		ttl: \DateInterval::createFromDateString('1 hour')
	);
```

There are also defaults for `->withMemoryCache()` - it stores at most 100 types, again without any expiration.
Configure it with:

```php
new ReflectorBuilder()
	->withMemoryCache(
		// 500 types metadata
		maxItems: 500,
		ttl: \DateInterval::createFromDateString('1 hour')
	);
```
